<!DOCTYPE html>
<html>
<body>

	<input type="text" id="searchField" placeholder="Search query...">
	<button onclick="searchStreams()">Search</button> </br>

	<p id="total"></p>
	<div id="streams">
		<div id="streamNode">
			<img id="image"></img>
			<h1 id="streamDisplayName"></h1>
			<p id="gameNameAndViews"></p>
			<p id="streamDescription"></p>
		</div>
	</div>

<script id="updateSearch">

var baseURL = "https://api.twitch.tv/kraken/search/streams?q=";
var callbackURL = ".json?count=10&callback=populate";

function createStreamDiv(streamData){
	var streamNode = document.getElementById("streamNode");
	var streamDiv = streamNode.cloneNode(true);
    streamDiv.image.src = twitch['preview']['small'];
    streamDiv.streamDisplayName.text = twitch['channel']['display_name'];
    document.getElementById('streams').appendChild(streamDiv);
}

function populate(jsonpObj){
    var text = '';

    var len = jsonpObj.streams.length;
    for(var i=0;i<len;i++){
        twitch = jsonpObj.streams[i];
        createStreamDiv(twitch);
        text += '<p><img src = "' + twitch['preview']['small'] +'"/>' + twitch['channel']['display_name'] + '</p>'
    }

    document.getElementById('total').innerHTML = "Total results: " + jsonpObj['_total'];
 }

 function searchStreams() {
 	// Set to lowercase and replace the spaces with %20
 	var search = document.getElementById('searchField').value.toLowerCase();
 	var replacedURL = search.replace(/ /g, "%20");

 	// Create a new script to call the populate function
 	var dynamicScript = document.createElement("script");
	dynamicScript.src = baseURL + replacedURL + callbackURL;
	document.getElementById('streams').appendChild(dynamicScript);
 }

</script>

</body>
</html>